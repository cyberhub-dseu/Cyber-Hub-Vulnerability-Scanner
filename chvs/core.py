import argparse
from chvs.network_scan import scan_network
from chvs.web_scan import scan_web
from chvs.report import generate_report

def main():
    # Setup argument parser
    parser = argparse.ArgumentParser(description="Cyber Hub Vulnerability Scanner (CHVS)")
    parser.add_argument("--target", required=True, help="Target IP, domain, or URL")
    parser.add_argument("--mode", required=True, choices=["network", "web"], help="Scan mode (network or web)")
    parser.add_argument("--output", default="json", choices=["json", "html", "csv"], help="Report output format")
    
    # Parse arguments
    args = parser.parse_args()
    
    # Perform scan based on mode
    try:
        if args.mode == "network":
            scan_results = scan_network(args.target)
        elif args.mode == "web":
            scan_results = scan_web(args.target)
        
        # Generate the report based on output format
        generate_report(scan_results, args.output)
        
        print(f"Scan completed. Report generated in {args.output} format.")
    
    except Exception as e:
        print(f"An error occurred: {e}")

if __name__ == "__main__":
    main()
